<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kris Sankaran">
<meta name="description" content="A look at the origins of the field.">

<title>STAT 436 Notes - A History of Data Visualization up to 1900</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 436 Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../documents.html"> 
<span class="menu-text">Documents</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/krisrs1128/stat436_notes"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#before-1600-early-maps-and-diagrams" id="toc-before-1600-early-maps-and-diagrams" class="nav-link active" data-scroll-target="#before-1600-early-maps-and-diagrams">Before 1600: Early Maps and Diagrams</a></li>
  <li><a href="#measurement-and-theory" id="toc-measurement-and-theory" class="nav-link" data-scroll-target="#measurement-and-theory">1600 - 1700: Measurement and Theory</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1700 - 1800</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">1800 - 1850</a></li>
  <li><a href="#the-golden-age" id="toc-the-golden-age" class="nav-link" data-scroll-target="#the-golden-age">1850 - 1900: The Golden Age</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A History of Data Visualization up to 1900</h1>
</div>

<div>
  <div class="description">
    <p>A look at the origins of the field.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kris Sankaran </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><em><a href="https://datavis.ca/papers/hbook.pdf">Reading</a>, <a href="https://mediaspace.wisc.edu/media/Week%2014%20%5B4%5D%20A%20History%20of%20Data%20Visualization%20up%20to%201900/1_ki8vpb8b">Recording</a>, <a href="https://github.com/krisrs1128/stat436_s24/blob/main/notes/2024-12-27-week14-4.Rmd">Rmarkdown</a></em></p>
<ol type="1">
<li>There could probably be an entire class taught on the history of data visualization. The reason it is worth covering in an otherwise practically-oriented class is that,
<ul>
<li>Historical study can illuminate the core intellectual foundation on which the entire discipline of data visualization is built.</li>
<li>The limits, biases, and trends of our current era become clear when considering it within its full historical context.</li>
<li>It’s often possible to draw inspiration from past masters.</li>
<li>It can be humbling to realize that now-commonplace ideas had to be discovered. If it took until 1833 until the first scatterplot was published, then what ideas have we yet to find?</li>
</ul></li>
<li>The reading divides up the history of data visualization into 8 epochs. In these notes, we will consider the 5 epochs before 1900.</li>
</ol>
<section id="before-1600-early-maps-and-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="before-1600-early-maps-and-diagrams">Before 1600: Early Maps and Diagrams</h3>
<ol start="3" type="1">
<li>It might come as a surprise, but visualization has been around since the invention of writing. The Egyptians made maps, and there are examples multiple time series plots from the 10th century.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://uwmadison.box.com/shared/static/w05yivo6v9dmj14kvjhcbon0de2gg1zl.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
<figcaption>Possibly the earliest multiple time series visualization showing the movement of various planets from <em>In Somnium Scripionus</em>.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li>However, most visualizations were focused on physical geographical or astronomical quantities, and even these quantities were only imprecisely measured. Without more formal data gathering instruments, there could not be much data visualization.</li>
</ol>
</section>
<section id="measurement-and-theory" class="level3">
<h3 class="anchored" data-anchor-id="measurement-and-theory">1600 - 1700: Measurement and Theory</h3>
<ol start="5" type="1">
<li>The situation begins to change around 1600, at the dawn of the scientific revolution. All of a sudden, precise measurement of physical space become possible. Also, important new mathematical ideas were introduced, like probability, calculus, and reasoning about functions. This created the right environment for the design of some of the first truly sophisticated data visualizations, like</li>
</ol>
<ul>
<li>Christopher Scheiner’s 1630 visualization of sunspots over time (a first instance of faceting),</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/d/dc/Scheiner_plate_observation_%283%29.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
<figcaption>Scheiner’s visualization of sunspots which played a role in his dialogues with Galileo.</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Edmond Halley’s plot of barometric pressure against altitude (an first instance of one feature being plotted against another), and</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://uwmadison.box.com/shared/static/193d54lhlhe4itlv5rc4zly3gd7r757p.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
<figcaption>One of the first bivariate plots relating barometric pressure to altitude. Note that absence of the true observed data.</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Edmond Halley’s plot of wind speed over the ocean (a first visualization of a vector field).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/a4/Edmond_Halley%27s_map_of_the_trade_winds%2C_1686.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
<figcaption>A plot of trade winds appearing in <em>An Historical Account of the Trade Winds and Monsoons Observable in the Seas between and near the Tropicks with an Attempt to Assign the Phisical Cause of the Said Wind</em>.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="6" type="1">
<li>During this period, the scientific value of visual thinking was more or less established. However, there were still only relatively few graphical forms available, and the focus continued to remain on visualizing physical quantities, rather than more general social, economic, biological, or ecological data.</li>
</ol>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">1700 - 1800</h3>
<ol start="7" type="1">
<li><p>During this period, many new graphical forms were invented, including timelines, cartograms, functional interpolations, line graphs, bar charts, and pie charts. Further, forms from earlier, like maps and function plots, became more firmly established.</p></li>
<li><p>This was also when three-color printing was invented. Before this point, color could not be used as an encoding channel.</p></li>
<li><p>In this century, governments also began large-scale data collection of social and economic statistics<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. One of the most prolific inventors of data visualizations, William Playfair<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, was used visualization to study a variety of economic problems. In addition to inventing line, bar, and pie charts, he experimented with original ways of composing multiple graphs to suggest the relationships between variables.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://uwmadison.box.com/shared/static/64v80q1lc8nsa9480i1etnz7wa54b2mn.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
<figcaption>One of William Playfair’s data visualizations juxtaposing the price of wheat with growth in wages.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">1800 - 1850</h3>
<ol start="10" type="1">
<li><p>This was a period of maturation for the field of data visualization. By this point, visualization had become standard in scientific publications. Advances in printing technology also made it also became easier to mass produce visualizations.</p></li>
<li><p>It was also around this time that the scope of problems studied through visualization expanded far beyond display of purely physical (geographical and astronomical) applications. Two areas in particular flourished, applications to social science and to engineering.</p></li>
</ol>
<ul>
<li>Visualization in the social sciences began to emerged in response to government sponsored collection of social statistics – data about crime, births, and deaths, among other topics. This wasn’t a purely intellectual exercise: understanding demographic trends was important for countries that were often at war with another.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/en/9/94/AMGuerry-carte2-low.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="350"></p>
<figcaption>A visualization of property crime statistics by Andre-Michel Guerry (1829).</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>In engineering, the idea that visualization could serve as a computational aid become more and more common. For example, rather the chart below, by Charles Joseph Minard, displays the cost of transporting goods across different stretches of a canal. Vertical breaks correspond to cities along the canal, and the area of the square between cities encodes the cost of transportation between those cities. While the information could be stored in a table, it becomes easier to perform mental computations (and make guesstimates) using the display.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/f/f8/Tableau_figuratif_du_mouvement_commercial_du_Canal_du_centre_en_1844.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
<figcaption>Minard’s 1844 visualization of the transport costs across the Canal du Centre in France.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-golden-age" class="level2">
<h2 class="anchored" data-anchor-id="the-golden-age">1850 - 1900: The Golden Age</h2>
<ol start="14" type="1">
<li><p>It might be counterintuitive that there was a golden age of visualization a century before the first computers were invented. However, a look at the visualizations from this period demonstrate that this was a period where visualizations inspired scientific discoveries, informed commercial decisions, and guided social reform.</p></li>
<li><p>For example, in public health, Florence Nightingale invented new visualizations to demonstrate the impact of sanitary practices in hospital-induced infections and death. Similarly, it was a <a href="https://en.wikipedia.org/wiki/The_Ghost_Map">visualization</a> that guided John Snow to the source of the 1855 cholera epidemic.</p></li>
</ol>
<div class="cell" data-layout-align="center" data-preview="true">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://uwmadison.box.com/shared/static/c79fbmfc3mff9ota1tzxtvv4gp7e3pul.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
<figcaption>Florence Nightingale’s visualization of hospital mortality statistics from the Crimean War used to support a campaign for sanitary reforms.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="16" type="1">
<li>Some of the graphical innovations include,</li>
</ol>
<ul>
<li>3D function plots. The plot below, by Luigi Perozzo, shows population size broken down into age groups and traced over time.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://uwmadison.box.com/shared/static/mm07qcwzwz5692rcluokmrx2o97jlr03.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
<figcaption>Luigi Perrozo’s 1879 3D visualizations of population over time.</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Flow diagrams. Charles-Joseph Minard, who we met before with the canal visualization, was a master of these displays. One in particular is widely considered a masterpiece, it shows the size of Napoleon’s army during it’s Russian Campaign.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Minard.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
<figcaption>Minard’s flow display of the size of Napoleon’s army during the Russia Campaign.</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Multivariate visualization. Francis Galton made some of the first efforts to visualize more than 3 variables at a time. His <em>Meteorographica</em>, published in 1863, contained over 600 visualizations of weather data that had been collected for decades, but never visualized. One plot, shown below, led to the discovery of anticyclones.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://uwmadison.box.com/shared/static/ar82ax7hcatpy99iz2w6opkzl4cdvv2y.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="550"></p>
<figcaption>Galton’s display of weather patterns. Low pressure (black) areas tend to have clockwise wind patterns while high pressure (red) tends to have anticlockwise wind patterns.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="17" type="1">
<li>This was also an age of state-sponsored atlases. More than sponsoring the collection of data, governments assembled teams to visualize the results for official publication. From 1879 to 1897, the French Ministry of Public Works published the <em>Albums de Statistique Graphique</em>, which under the guidance of Émile Cheysson, developed some of the most imaginative and ambitious visualizations of the era.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/f/f1/Exp%C3%A9ditions_de_voyageurs_et_de_marchandises.png?1619305371810" class="img-fluid quarto-figure quarto-figure-center figure-img" width="450"></p>
<figcaption>A visualization of the flow of passengers and goods through railways from Paris. Each square shows the breakdown to cities further away and color encodes the railines.</figcaption>
</figure>
</div>
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The word “statistics” comes from the same root as “state”, since it originally focused on data collected for governance.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>He has been described as an “engineer, political economist and scoundrel.”<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>